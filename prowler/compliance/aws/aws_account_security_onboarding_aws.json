{
    "Framework": "AWS-Account-Security-Onboarding",
    "Version": "",
    "Provider": "AWS",
    "Description": "Checklist when onboarding new AWS Accounts to existing AWS Organization.",
    "Requirements": [
      {
        "Id": "deploy-an-account-from-predefined-IaC-template",
        "Name": "Deploy an account from predefined IaC template",
        "Description": "Deploy an account from predefined IaC template",
        "Attributes": [
          {
            "Section": "Predefine IAM Roles",
            "Service": "IAM"
          },
          {
            "Section": "Enabled security services"
          },
          {
            "Section": "IDC integration and SSO configuration for AWS Account"
          },
          {
            "Section": "Organization invitation",
            "Service": "Organizations"
          },
          {
            "Section": "Billing, emergency, and security contacts",
            "Service": "Billing"

          },
          {
            "Section": "Root user have distribute email + MFA",
            "Service": "IAM"
          },
          {
            "Section": "S3 Block Public Access",
            "Service": "S3"
          },
          {
            "Section": "Disable AMI public sharing",
            "Service": "EC2"
          }
        ],
        "Checks": [
          "iam_no_custom_policy_permissive_role_assumption",
          "iam_policy_attached_only_to_group_or_roles",
          "iam_support_role_created",
          "iam_role_cross_service_confused_deputy_prevention",
          "account_maintain_current_contact_details",
          "account_security_contact_information_is_registered",
          "iam_root_mfa_enabled",
          "cloudtrail_logs_s3_bucket_is_not_publicly_accessible",
          "ec2_ami_public"
        ]
      },
      {
        "Id": "SPCS",
        "Name": "SPCS",
        "Description": "SPCS in your AWS Account.",
        "Attributes": [
          {
            "Section": "Apply existing SPCS based on OU placement",
            "SubSection": "Block unused regions"
          },
          {
            "Section": "Apply existing SPCS based on OU placement",
            "SubSection": "Block tampering with security-related settings and services"
          },
          {
            "Section": "Apply existing SPCS based on OU placement",
            "SubSection": "Restrict instances types"
          },
          {
            "Section": "Apply existing SPCS based on OU placement",
            "SubSection": "Block root user"
          },
          {
            "Section": "Add custom SPCS if required"
          }
        ],
        "Checks": [
          "iam_no_root_access_key"
        ]
      },
      {
        "Id": "Logging",
        "Name": "Logging",
        "Description": "Logging in your AWS Account.",
        "Attributes": [
          {
            "Section": "Send DNS resolvers queries to SIEM",
            "Service": "DNS"
          },
          {
            "Section": "Send VPC flow logs (only denys) to S3 bucket",
            "Service": "VPC"

          },
          {
            "Section": "Send S3 access logs for critical buckets to separate S3 bucket",
            "Service": "S3"
          },
          {
            "Section": "Establish ready-to-be-enabled pipelines to deliver ALB and CFD to SIEM to toggle in case of emergency and investigations"
          }
        ],
        "Checks": [
            "cloudtrail_logs_s3_bucket_access_logging_enabled",
            "cloudtrail_s3_dataevents_write_enabled"
        ]
      },
      {
        "Id": "Alerting",
        "Name": "Alerting",
        "Description": "Enable alerts in your AWS Account.",
        "Attributes": [
          {
            "Section": "GuardDuty",
            "SubSection": "Alert on each High finding",
            "Service": "GuardDuty"
          },
          {
            "Section": "GuardDuty",
            "SubSection": "Alerts based on aggregated findings with severity Medium and below",
            "Service": "GuardDuty"
          },
          {
            "Section": "Cloudtrail",
            "SubSection": "Critical alert on every root user activity",
            "Service": "CloudTrail"
          },
          {
            "Section": "Cloudtrail",
            "SubSection": "Critical alert on cloudtrail settings changes",
            "Service": "CloudTrail"
          },
          {
            "Section": "Cloudtrail",
            "SubSection": "Alert on rise of ConsoleLoginFailures events",
            "Service": "CloudTrail"
          },
          {
            "Section": "Cloudtrail",
            "SubSection": "Alert on IAM user changes",
            "Service": "CloudTrail"
          },
          {
            "Section": "Cloudtrail",
            "SubSection": "Alert on snapshot manipulations",
            "Service": "CloudTrail"
          },
          {
            "Section": "Cost Anomaly",
            "Service": "Billing"
          },
          {
            "Section": "SecurityHub",
            "SubSection": "Alerts based on (at least) each new CRITICAL finding",
            "Service": "SecurityHub"
          },
          {
            "Section": "SecurityHub",
            "SubSection": "Realert on inactivity in a set period",
            "Service": "SecurityHub"
          },
          {
            "Section": "WAF",
            "SubSection": "Alerts based on rate-based rules",
            "Service": "WAF"
          },
          {
            "Section": "WAF",
            "SubSection": "Alerts based on high amount of blocked requests by managed rules",
            "Service": "WAF"
          },
          {
            "Section": "Shield",
            "SubSection": "Alert based on DDoSDetected metric",
            "Service": "Shield"
          },
          {
            "Section": "Shield",
            "SubSection": "Adopt incident response guide and prepared battle card",
            "Service": "Shield"
          },
          {
            "Section": "R53 DNS Resolver",
            "Service": "Route53"
          },
          {
            "Section": "Vulnerability Scanning",
            "Service": "Inspector"
          }
        ],
        "Checks": [
          "cloudwatch_log_metric_filter_and_alarm_for_cloudtrail_configuration_changes_enabled"
        ]
      },
      {
        "Id": "Budget-Alarms",
        "Name": "Budget-Alarms",
        "Description": "Budget Alarms for your AWS Account.",
        "Attributes": [
          {
            "Section": "Prod"
          },
          {
            "Section": "QA",
            "SubSection": "Create Cost Anomaly Detection monitors to alert spending anomalies",
            "Service": "CloudWatch"
          },
          {
            "Section": "QA",
            "SubSection": "Configure Budgets Actions to stop services in cases of big unexpected spendings",
            "Service": "SNS"
          }
        ],
        "Checks": []
      },
      {
        "Id": "IAM-Access-Analyzer",
        "Name": "IAM access analyzer",
        "Description": "IAM access analyzer in your AWS Account.",
        "Attributes": [
          {
            "Section": "Create analyzers in each active regions",
            "Service": "IAM"
          },
          {
            "Section": "Verify that events are present in SecurityHub aggregated view",
            "Service": "SecurityHub"
          }
        ],
        "Checks": [
          "securityhub_enabled",
          "accessanalyzer_enabled",
          "accessanalyzer_enabled_without_findings"
        ]
      },
      {
        "Id": "Macie",
        "Name": "Macie",
        "Description": "Macie in your AWS Account.",
        "Attributes": [
          {
            "Section": "Consider enabling for critical buckets only",
            "Service": "Macie"
          }
        ],
        "Checks": [
          "macie_is_enabled"
        ]
      },
      {
        "Id": "Vulnerability-Scanning",
        "Name": "Vulnerability Scanning",
        "Description": "Vulnearbility Scanning in your AWS Account.",
        "Attributes": [
          {
            "Section": "EC2 used as servers",
            "SubSection": "Enable and configure AWS Inspector",
            "Service": "EC2"
          },
          {
            "Section": "EC2 used as servers",
            "SubSection": "Export scan results as metrics in centralized collector",
            "Service": "EC2"
          },
          {
            "Section": "ECR used as docker image hub",
            "SubSection": "Scan images for vulnerability on upload to ECR",
            "Service": "ECR"
          },
          {
            "Section": "ECR used as docker image hub",
            "SubSection": "Deploy solution to periodically rescan currently used images and report found vulnerabilities",
            "Service": "ECR"
          },
          {
            "Section": "ECR used as docker image hub",
            "SubSection": "Export scan results as metrics in centralized collector",
            "Service": "ECR"
          }
        ],
        "Checks": [
          "inspector2_findings_exist",
          "ecr_repositories_scan_images_on_push_enabled",
          "ecr_repositories_lifecycle_policy_enabled",
          "ecr_repositories_scan_vulnerabilities_in_latest_image",
          "ecr_registry_scan_images_on_push_enabled"
        ]
      },
      {
        "Id": "AWS-Clousdtrail",
        "Name": "AWS Cloustrail",
        "Description": "Cloudtrail in your AWS Account.",
        "Attributes": [
          {
            "Section": "Enable as part of Organization trail",
            "Service": "CloudTrail"
          },
          {
            "Section": "Confirm that logs are present in S3 bucket and SIEM",
            "Service": "CloudTrail"
          }
        ],
        "Checks": [
          "cloudtrail_cloudwatch_logging_enabled",
          "cloudtrail_logs_s3_bucket_access_logging_enabled",
          "cloudtrail_multi_region_enabled",
          "cloudtrail_multi_region_enabled_logging_management_events",
          "cloudtrail_s3_dataevents_read_enabled",
          "cloudtrail_s3_dataevents_write_enabled"
        ]
      },
      {
        "Id": "Enable-AWS-SecurityHub",
        "Name": "Enable AWS SecurityHub",
        "Description": "SecurityHub in your AWS Account.",
        "Attributes": [
          {
            "Section": "Deploy solution to alert on at least critical new findings",
            "Service": "SecurityHub"
          },
          {
            "Section": "Apply SecurityHub Central Configuration for Organization",
            "Service": "SecurityHub"
          },
          {
            "Section": "Enable/disable additional standards and controls",
            "Service": "SecurityHub" 
          },
          {
            "Section": "Confirm that findings are being visible in the aggregated view",
            "Service": "SecurityHub"
          },
          {
            "Section": "Ensure that there are no critical (and considered critical) findings present in account",
            "Service": "SecurityHub"
          }
        ],
        "Checks": [
          "securityhub_enabled"
        ]
      },
      {
        "Id": "Enable-AWS-Config",
        "Name": "Enable AWS Config",
        "Description": "AWS Config in your AWS Account.",
        "Attributes": [
          {
            "Section": "Enable continuous recording for most of the resources",
            "Service": "Config"
          },
          {
            "Section": "Consider periodic recording for resources to optimize bill",
            "Service": "Config"
          },
          {
            "Section": "Confirm that resources are present in central aggregator",
            "Service": "Config"
          }
        ],
        "Checks": [
          "config_recorder_all_regions_enabled"
        ]
      },
      {
        "Id": "Enable-GuardDuty",
        "Name": "Enable AWS GuardDuty",
        "Description": "GuardDuty in your AWS Account.",
        "Attributes": [
          {
            "Section": "Enable as part of central configuration for Organization",
            "Type": "Must",
            "Service": "GuardDuty"
          },
          {
            "Section": "Threat Detection",
            "Type": "Must",
            "Service": "GuardDuty"
          },
          {
            "Section": "RDS protection",
            "Type": "Must",
            "Service": "RDS"
          },
          {
            "Section": "Lambda protection",
            "Type": "Must",
            "Service": "Lambda"
          },
          {
            "Section": "S3 protection",
            "Type": "Must",
            "Service": "S3"
          },
          {
            "Section": "Malware Scanning",
            "Type": "Must",
            "Service": "GuardDuty"
          },
          {
            "Section": "Confirm that events are present in SIEM",
            "Type": "Must",
            "Service": "GuardDuty"
          },
          {
            "Section": "Apply suppression filters to disable useless findings",
            "Type": "Must",
            "Service": "GuardDuty"
          },
          {
            "Section": "Include in process of incident response based on events",
            "Type": "Must",
            "Service": "GuardDuty"
          },
          {
            "Section": "Runtime protection",
            "Type": "Optional",
            "SubSection": "Very new, needs testing"
          },
          {
            "Section": "Runtime protection",
            "Type": "Optional",
            "SubSection": "As alternative - another runtime protection, if available"
          },
          {
            "Section": "EKS protection (if EKS is used)",
            "Type": "Optional",
            "Service": "EKS"
          }
        ],
        "Checks": [
          "guardduty_is_enabled",
          "guardduty_no_high_severity_findings",
          "guardduty_centrally_managed"
        ]
      },
      {
        "Id": "R53-DNS-Resolver-Firewall",
        "Name": "R53 DNS Resolver Firewall",
        "Description": "R53 DNS Resolver Firewall in your AWS Account.",
        "Attributes": [
          {
            "Section": "Apply managed domain Section lists for resolver in block mode",
            "Service": "Route53"
          },
          {
            "Section": "Use strictly AWS VPC DNS Resolver",
            "Service": "Route53"
          },
          {
            "Section": "Ban outbound DNS calls from all VPCs to ports 53",
            "Service": "Route53"
          },
          {
            "Section": "Apply custom threat list for GuardDuty to alert on access to DoH servers",
            "Service": "GuardDuty"
          }
        ],
        "Checks": [
          "route53_domains_privacy_protection_enabled",
          "route53_domains_transferlock_enabled"
        ]
      },
      {
        "Id": "Shield-Advanced",
        "Name": "Shield Advanced",
        "Description": "Shield advanced in your AWS Account.",
        "Attributes": [
          {
            "Section": "Enable Shield Advanced subscription for public facing account",
            "Service": "Shield"
          },
          {
            "Section": "Export metrics in centralized collector",
            "Service": "CloudWatch"
          },
          {
            "Section": "Create DDoS battle card with main info about protected services",
            "Service": "Shield"
          }
        ],
        "Checks": [
          "shield_advanced_protection_in_route53_hosted_zones",
          "shield_advanced_protection_in_classic_load_balancers",
          "shield_advanced_protection_in_internet_facing_load_balancers",
          "shield_advanced_protection_in_cloudfront_distributions"
        ]
      },
      {
        "Id": "WAFv2",
        "Name": "WAFv2",
        "Description": "WAFv2 in your AWS Account.",
        "Attributes": [
          {
            "Section": "Deploy WAF setup for each public web service",
            "SubSection": "CFD + ALB + secret rotation architecture",
            "Type":"Must",
            "Service": "WAF"
          },
          {
            "Section": "Deploy WAF setup for each public web service",
            "SubSection": "Predefined set of managed rules",
            "Type":"Must",
            "Service": "WAF"
          },
          {
            "Section": "Deploy WAF setup for each public web service",
            "SubSection": "Global allow - and block-lists",
            "Type":"Must",
            "Service": "WAF"
          },
          {
            "Section": "Deploy WAF setup for each public web service",
            "SubSection": "Blanket rate-based rules",
            "Type":"Must",
            "Service": "WAF"
          },
          {
            "Section": "Deploy WAF setup for each public web service",
            "SubSection": "Service-unique exclusion rules",
            "Type":"Must",
            "Service": "WAF"
          },
          {
            "Section": "Deploy WAF setup for each public web service",
            "SubSection": "Additional managed rules",
            "Type":"Discuss",
            "Service": "WAF"
          },
          {
            "Section": "Deploy WAF setup for each public web service",
            "SubSection": "Scoped-down rate-based rules",
            "Type":"Discuss",
            "Service": "WAF"
          },
          {
            "Section": "Enable Shield Advanced automatic application layer DDoS mitigation",
            "SubSection": "For first 2 weeks - in COUNT mode",
            "Service": "Shield"
          },
          {
            "Section": "Enable Shield Advanced automatic application layer DDoS mitigation",
            "SubSection": "After that - switch into BLOCK mode",
            "Service": "Shield"
          },
          {
            "Section": "Configure R53 health checks for all protected resources",
            "Service": "Route53"
          },
          {
            "Section": "Configure sensitive fields redaction and send WAF logs to SIEM",
            "Service": "WAF"
          },
          {
            "Section": "Export metrics in centralized collector",
            "Service": "CloudWatch"
          }
        ],
        "Checks": [
          "apigateway_restapi_waf_acl_attached",
          "elbv2_waf_acl_attached"
        ]
      }
    ]
}